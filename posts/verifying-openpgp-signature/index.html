<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://zzmzaw.github.io name=base><title>ZzMzaw's blog • Verifying the OpenPGP signature of dowloaded files</title><link title="ZzMzaw's blog - Atom Feed" href=https://zzmzaw.github.io/atom.xml rel=alternate type=application/atom+xml><link href="https://zzmzaw.github.io/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://zzmzaw.github.io/main.css?h=4a3dff148c520f191505" rel=stylesheet><link href="https://zzmzaw.github.io/misc.css?h=9b0f483dae9c0c16a211" rel=stylesheet><link href="https://zzmzaw.github.io/cc.css?h=47dd58492ac53967cae5" rel=stylesheet><link href="https://zzmzaw.github.io/series.css?h=e60f43ddd4c582055a83" rel=stylesheet><link href="https://zzmzaw.github.io/skins/lavender.css?h=31ee0a710ed660d122f6" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="How to verify an OpenPGP signature and why it is important" name=description><meta content="How to verify an OpenPGP signature and why it is important" property=og:description><meta content="Verifying the OpenPGP signature of dowloaded files" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale:alternate><link href=https://zzmzaw.github.io/posts/verifying-openpgp-signature/ hreflang=en rel=alternate><meta content=fr_FR property=og:locale:alternate><link href=https://zzmzaw.github.io/fr/posts/verifying-openpgp-signature/ hreflang=fr rel=alternate><meta content=https://zzmzaw.github.io/posts/verifying-openpgp-signature/ property=og:url><meta content="ZzMzaw's blog" property=og:site_name><meta content="default-src 'self';font-src 'self' data: 'self';img-src 'self' https://* data:;media-src 'self' https://cdn.jsdelivr.net/;style-src 'self' 'unsafe-inline';connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><noscript><link href=https://zzmzaw.github.io/no_js.css rel=stylesheet></noscript><script src=https://zzmzaw.github.io/js/initializeTheme.min.js></script><script defer src=https://zzmzaw.github.io/js/themeSwitcher.min.js></script><script src="https://zzmzaw.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://zzmzaw.github.io>ZzMzaw's blog</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://zzmzaw.github.io/posts/> posts </a><li><a class="nav-links no-hover-padding" href=https://zzmzaw.github.io/archive/> archive </a><li><a class="nav-links no-hover-padding" href=https://zzmzaw.github.io/tags/> tags </a></li><div class=nav-navs id=menu-icons-group><li class=js><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class=language-switcher><details class=dropdown><summary aria-label="Language selection" title="Language selection" aria-haspopup=true role=button><div class=language-switcher-icon></div></summary> <div class=dropdown-content role=menu>English<a aria-label=Français href=https://zzmzaw.github.io/fr/posts/verifying-openpgp-signature/ lang=fr role=menuitem>Français</a></div></details><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></div></ul></div></nav></header><div class=content><main><article><h1 class=article-title>Verifying the OpenPGP signature of dowloaded files</h1><ul class=meta><li>29th Dec 2024<li title="1484 words"><span aria-hidden=true class=separator>•</span>8 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a href=https://zzmzaw.github.io/tags/security/>security</a></ul><section class=body><p>When an important file is available for download, there is usually a signature file not far away from it.<p>If it is not the case, you should think twice before using the file you just downloaded.<p>Anyway, when a signature is made available, you should take the time to verify it.<h1 id=why-verifying-the-signature-of-a-downloaded-file><a aria-label="Anchor link for: why-verifying-the-signature-of-a-downloaded-file" class="header-anchor no-hover-padding" href=#why-verifying-the-signature-of-a-downloaded-file><span aria-hidden=true class=link-icon></span></a> Why verifying the signature of a downloaded file?</h1><p>We can consider there are multiple actions and actors when a file is made available for download and downloaded:</p><noscript><strong>⚠️ JavaScript is required to render the diagram.</strong></noscript><pre class="mermaid invertible-image">
    sequenceDiagram
    actor provider as File Provider
    participant storage as File Storage
    actor user as File User
    provider ->> provider: Generate the file
    provider ->> storage: Make the file available for download
    activate storage
    user ->> storage: Download the file
    note right of storage: File may stay in the storage for a very long time
    deactivate storage
</pre><p>How do you know that the file you downloaded is the one which has been generated? Maybe someone accessed the storage and modified it. Maybe someone is able to modify it on the fly while you download it.<p>Verifying the signature is important because this is the only way to make sure the file has not been tampered with since it was signed, neither in its storage nor during its transfer, when you downloaded it.<p>In order to allow signature verification, a signature of the file is created with a private key owned by the file provider just after the file has been generated. This operation usually happens in a safe place (at least as safe as possible) before the file is uploaded to the file storage, where it may stay unmonitored for a very long time.</p><noscript><strong>⚠️ JavaScript is required to render the diagram.</strong></noscript><pre class="mermaid invertible-image">
    sequenceDiagram
    actor provider as File Provider
    participant storage as File Storage
    actor user as File User
    provider ->> provider: Generate the file
    provider ->> provider: Sign the file
    provider ->>+ storage: Make the file available for download
    activate storage
    provider ->> storage: Make the signature available for download
    user ->> storage: Download the file
    user ->> storage: Download the signature
    user ->> user: Verify the signature
    deactivate storage
</pre><p>For sure, signature verification doesn't prevent the file to be poisoned before or during its generation or signature. It doesn't prevent neither private key misuse nor abuse.<p>Nevertheless, those are all active threats which happen at a time when the file provider is usually careful about the file and this should be covered by the trust you have in the file provider.<h1 id=how-does-digital-signature-work><a aria-label="Anchor link for: how-does-digital-signature-work" class="header-anchor no-hover-padding" href=#how-does-digital-signature-work><span aria-hidden=true class=link-icon></span></a> How does digital signature work?</h1><p>Signature and signature verification rely on asymmetric cryptography <sup class=footnote-reference id=fr-1-1><a href=#fn-1>[1]</a></sup> and cryptographic hashes <sup class=footnote-reference id=fr-2-1><a href=#fn-2>[2]</a></sup>. It applies not only to a file but to any kind of data.<p>"Asymmetric cryptography" just means we're using a key pair, a private key and a public key, to perform cryptographic operations. I won't go into too many details here, but you just have to keep in mind that asymmetric cryptography relies on the assumption that there is no way to compute or guess the private key from the public key. The private key must be kept secret and used by only one person (or a small group) and the public key is... public and can be shared to anyone.<p>Cryptographic hash can be defined as a one-way function which transforms any input in a fixed-length unique output. It relies on output uniqueness, whatever the input is and the assumption that the function cannot be reverted (you cannot compute or guess the input from the output). If collisions exist (i.e. two different inputs generate the same output) then the hash function is considered weak and should not be used anymore.<p>The process of signing some data usually involves hashing it and encrypting the hash with the private key to create a signature, then providing the signature alongside the data in a way or another.</p><noscript><strong>⚠️ JavaScript is required to render the diagram.</strong></noscript><pre class="mermaid invertible-image">
    flowchart LR
    e_data@{ label: "Data", shape: in-out }
    e_privkey@{ label: "Private Key", shape: in-out }
    e_hash@{ label: "Hash", shape: in-out }
    e_sign@{ label: "Signature", shape: in-out }
    a_hash@{ label: "Hash the data", shape: process }
    a_encrypt@{ label: "Encrypt the hash", shape: process }
    a_store@{ label: "Glue the data and the signature together", shape: double-circle }
    
    e_data --> a_hash --> e_hash
    e_hash --> a_encrypt --> e_sign
    e_privkey ----> a_encrypt
    e_data --> a_store
    e_sign --> a_store
</pre><p>The signature of the data can be verified by retrieving both the signature and the data, decrypting the hash from the signature with the public key, and hashing the data again. The signature is considered valid if the two hashes match each other.</p><noscript><strong>⚠️ JavaScript is required to render the diagram.</strong></noscript><pre class="mermaid invertible-image">
    flowchart LR
    e_data@{ label: "Data", shape: in-out }
    e_sign@{ label: "Signature", shape: in-out }
    e_pubkey@{ label: "Public Key", shape: in-out }
    e_hash_data@{ label: "Hash from data", shape: in-out }
    e_hash_sig@{ label: "Hash from signature", shape: in-out }
    a_hash@{ label: "Hash the data", shape: process }
    a_decrypt@{ label: "Decrypt the signature", shape: process }
    a_compare{Compare hashes}
    s_sign_ok@{ label: " Signature is **valid** ", shape: double-circle }
    s_sign_ko@{ label: "Signature is **invalid**", shape: double-circle }
    
    e_data --> a_hash --> e_hash_data
    e_sign --> a_decrypt --> e_hash_sig
    e_pubkey --> a_decrypt
    e_hash_data --> a_compare
    e_hash_sig --> a_compare
    a_compare -- Equals --> s_sign_ok
    a_compare -- Not equals --> s_sign_ko
</pre><h1 id=verifying-the-openpgp-signature-of-a-downloaded-file><a aria-label="Anchor link for: verifying-the-openpgp-signature-of-a-downloaded-file" class="header-anchor no-hover-padding" href=#verifying-the-openpgp-signature-of-a-downloaded-file><span aria-hidden=true class=link-icon></span></a> Verifying the OpenPGP signature of a downloaded file</h1><p>PGP <sup class=footnote-reference id=fr-3-1><a href=#fn-3>[3]</a></sup> stands for Pretty Good Privacy and lead to the creation of the OpenPGP standard <sup class=footnote-reference id=fr-4-1><a href=#fn-4>[4]</a></sup>, which is widely used to sign and/or encrypt emails and files.<p>Verifying the PGP signature of a downloaded file usually involves GNU Privacy Guard <sup class=footnote-reference id=fr-5-1><a href=#fn-5>[5]</a></sup> also known as <code>gpg</code> (even if there could be other methods).<p>On Linux, it is as simple as issuing one of the following commands, assuming both the file and its signature are in the same folder (e.g. <code>/path/to/the/files</code>):<div class=full-width><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-cd z-shell">cd</span></span><span class="z-meta z-function-call z-arguments z-shell"> /path/to/the/files</span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Assuming signature file name is the same as the signed file name</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> with an additional extension (e.g. `.sig`, `.asc`...)</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>verify</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>&LTyour-signature-file><span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> If file name cannot be infered from signature name</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>verify</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>&LTyour-signature-file><span class="z-punctuation z-definition z-string z-end z-shell">'</span></span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>&LTyour-signed-file><span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span></code></pre></div><p>If you try to verify the signature of a file without importing the associated public key, <code>gpg</code> throws a <code>Can't check signature: No public key</code> error:<div class=full-width><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>verify</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>&LTyour-signature-file><span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: assuming signed data in '&LTyour-signed-file>'</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: Signature made &LTsignature-date></span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg:                using RSA key XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: Can't check signature: No public key</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre></div><p>Nothing has been verified there, so you need to import the public key associated to the signature first.<p>In order to import the key, you need to first know where you can retrieve it from. This is usually provided with the file and its signature or in the file installation documentation.<p>Once known, downloading and importing the key is as simple as issuing the following command:<div class=full-width><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Download the key and import it at once</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">wget</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>&LTremote-key-location<span class="z-punctuation z-definition z-string z-end z-shell">'</span></span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>q0</span> -</span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>import</span> -</span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: key YYYYYYYYYYYYYYYY: Z signatures not checked due to missing keys</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: key YYYYYYYYYYYYYYYY: public key "&LTkey-owner>" imported</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: Total number processed: 1</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg:               imported: 1</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: no ultimately trusted keys found</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre></div><p>But how do you make sure the key you imported is the one you expected?<p>Keys can be nested (as it is for Certificates Authorities used for HTTPS) and you can sign a key with another key. If you want to deeply trust a key, you should start trusting its parent keys first. Here, we directly import the key we need which explain why we have the message <code>no ultimately trusted keys found</code>. If we had imported and trusted the root key and imported all the intermediary keys the key which signed the file depends on if any, this message would not be there.<p>Most of the time though, the key you import is standalone such as a root key (which has no parent). In that case, the only thing you can do is to compare its fingerprint with the one provided (when it is provided) before trusting it.<p>You can also look for other sources of the public key to compare its fingerprint with. Usually, developers tend to put their public key in several independent places (public profiles, repos, websites, ...) so it might be possible to compare several fingerprints to prevent a bit more public key tampering.<p>You can also check a public key fingerprint without importing it by downloading it and displaying its content:<div class=full-width><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">wget</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>&LTremote-key-location><span class="z-punctuation z-definition z-string z-end z-shell">'</span></span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>q0</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>O</span> /path/to/local/key</span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Key fingerprint is on the second line, a string composed of</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> 40 alphanumerical characters (replaced by all the X here)</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>show-keys</span> /path/to/local/key</span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> pub   &LTpub-key-algorithm> &LTpub-key-generation-date> [&LTpub-key-usages>] [expires: &LTpub-key-expiration-date>]</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">>       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> uid                      &LTuid1></span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> uid                      &LTuid2></span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> uid                      ...</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> sub   &LTsub-key-algorithm> &LTsub-key-generation-date> [&LTsub-key-usages>]</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre></div><p>If you consider the key as trusted, you can import it with the following command:<div class=full-width><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>import</span> /path/to/local/key</span>
</span></code></pre></div><p>Last but not least, You can retrieve the fingerprint of already imported keys with the following command:<div class=full-width><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> Key fingerprint is on the second line, a string composed of</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> 40 alphanumerical characters (replaced by all the X here)</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>fingerprint</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> /path/to/keyring</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> ----------------</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> pub   &LTpub-key-algorithm> &LTpub-key-generation-date> [&LTpub-key-usages>] [expires: &LTpub-key-expiration-date>]</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">>       XXXX XXXX XXXX XXXX XXXX  XXXX XXXX XXXX XXXX XXXX</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> uid           [uid1-trust] &LTuid1></span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> uid           [uid2-trust] &LTuid2></span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> uid           ...</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> sub   &LTsub-key-algorithm> &LTsub-key-generation-date> [&LTsub-key-usages>]</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> ... same for other keys ...</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre></div><p>PGP is all about building trust in a digital world. <code>gpg</code> is able to adapt its behavior depending on the level of trust you declare on each imported key.<p>I won't go in the details of this feature as it should not be so useful in the case of a one-shot signature verification for the file unless you plan to do it regularly.<p>If you want to go deeper on this topic, you can look at <a rel="noopener nofollow noreferrer" href=https://www.qubes-os.org/security/verifying-signatures/ target=_blank>the explanations and instructions provided by Qubes OS regarding signature verification</a> which use nested keys and explains how to trust a key.<p>Now keys are imported, let's verify the file again.<p>If the signature is valid, we have a <code>Good signature</code> successful message:<div class=full-width><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gpg</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>verify</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">'</span>&LTyour-signature-file><span class="z-punctuation z-definition z-string z-end z-shell">'</span></span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: assuming signed data in '&LTyour-signed-file>'</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: Signature made &LTsignature-date></span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg:                using RSA key XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: Good signature from &LTuid1> [&LTuid1-trust]</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg:                 aka &LTuid2> [&LTuid2-trust]</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg:                 aka ...</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: WARNING: This key is not certified with a trusted signature!</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg:          There is no indication that the signature belongs to the owner.</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> Primary key fingerprint: XXXX XXXX XXXX XXXX XXXX  XXXX XXXX XXXX XXXX XXXX</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre></div><p>We have a <code>BAD signature</code> error message otherwise:<div class=full-width><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: assuming signed data in '&LTyour-signed-file>'</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: Signature made &LTsignature-date></span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg:                using RSA key XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span class="z-comment z-line z-number-sign z-shell">
</span></span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell">> gpg: BAD signature from &LTuid1> [&LTuid1-trust>]</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre></div><p>If the signature is valid, you can use the file safely. But if it is not the case, I would strongly advise discarding the file. You can try to download and verify it again, but if the bad signature persists, you should get in touch with the file provider before going further.<hr><ol class=footnotes-list><li id=fn-1><p><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Public-key_cryptography target=_blank>https://en.wikipedia.org/wiki/Public-key_cryptography</a> <a href=#fr-1-1>↩</a></p><li id=fn-2><p><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Cryptographic_hash_function target=_blank>https://en.wikipedia.org/wiki/Cryptographic_hash_function</a> <a href=#fr-2-1>↩</a></p><li id=fn-3><p><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Pretty_Good_Privacy target=_blank>https://en.wikipedia.org/wiki/Pretty_Good_Privacy</a> <a href=#fr-3-1>↩</a></p><li id=fn-4><p><a rel="noopener nofollow noreferrer" href=https://datatracker.ietf.org/doc/html/rfc9580 target=_blank>https://datatracker.ietf.org/doc/html/rfc9580</a> <a href=#fr-4-1>↩</a></p><li id=fn-5><p><a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/GNU_Privacy_Guard target=_blank>https://en.wikipedia.org/wiki/GNU_Privacy_Guard</a> <a href=#fr-5-1>↩</a></p></ol></section><nav class="full-width article-navigation"><div><a aria-describedby=left_title aria-label=Prev href=https://zzmzaw.github.io/posts/a-not-so-badly-secure-os-config/01-choosing-the-os/><span class=arrow>←</span> Prev</a><p aria-hidden=true id=left_title>Choosing an OS according to expectations and security threats</div><div><a aria-describedby=right_title aria-label=Next href=https://zzmzaw.github.io/posts/a-not-so-badly-secure-os-config/02-preparing-guix-system-installation/>Next <span class=arrow>→</span></a><p aria-hidden=true id=right_title>Preparing for Guix System installation</div></nav></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://zzmzaw.github.io/posts/verifying-openpgp-signature/#why-verifying-the-signature-of-a-downloaded-file>Why verifying the signature of a downloaded file?</a><li><a href=https://zzmzaw.github.io/posts/verifying-openpgp-signature/#how-does-digital-signature-work>How does digital signature work?</a><li><a href=https://zzmzaw.github.io/posts/verifying-openpgp-signature/#verifying-the-openpgp-signature-of-a-downloaded-file>Verifying the OpenPGP signature of a downloaded file</a></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><script defer src=https://zzmzaw.github.io/js/mermaid.min.js></script><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://zzmzaw.github.io/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer" href=https://zzmzaw.github.io/atom.xml target=_blank> <img alt=feed loading=lazy src=https://zzmzaw.github.io/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://github.com/ZzMzaw target=_blank> <img alt=github loading=lazy src=https://zzmzaw.github.io/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://gitlab.com/ZzMzaw target=_blank> <img alt=gitlab loading=lazy src=https://zzmzaw.github.io/social_icons/gitlab.svg title=gitlab> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://matrix.to/#/@zzmzaw:zzmzaw.dev target=_blank> <img alt=matrix loading=lazy src=https://zzmzaw.github.io/social_icons/matrix.svg title=matrix> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://discordapp.com/users/1199491352623337594 target=_blank> <img alt=discord loading=lazy src=https://zzmzaw.github.io/social_icons/discord.svg title=discord> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://www.root-me.org/ZzMzaw target=_blank> <img alt=rootme loading=lazy src=https://zzmzaw.github.io/social_icons/rootme.svg title=rootme> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://app.hackthebox.com/users/1823204 target=_blank> <img alt=hackthebox loading=lazy src=https://zzmzaw.github.io/social_icons/hackthebox.svg title=hackthebox> </a><li><a class="nav-links no-hover-padding social" href="https://news.ycombinator.com/user?id=zzmzaw" rel="noopener noreferrer me" target=_blank> <img alt=hacker-news loading=lazy src=https://zzmzaw.github.io/social_icons/hacker-news.svg title=hacker-news> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://www.reddit.com/user/ZzMzaw target=_blank> <img alt=reddit loading=lazy src=https://zzmzaw.github.io/social_icons/reddit.svg title=reddit> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://stackoverflow.com/users/23289335/zzmzaw target=_blank> <img alt=stack-overflow loading=lazy src=https://zzmzaw.github.io/social_icons/stack-overflow.svg title=stack-overflow> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://xdaforums.com/m/zzmzaw.11836937/ target=_blank> <img alt=xda loading=lazy src=https://zzmzaw.github.io/social_icons/xda.svg title=xda> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://zzmzaw.github.io/about/> about </a><li><a class="nav-links no-hover-padding" href=https://zzmzaw.github.io/privacy/> privacy policy </a><li><a class="nav-links no-hover-padding" href=https://zzmzaw.github.io/sitemap.xml> sitemap </a></ul> </small></nav><div class=credits><small> <p><p><a rel="noopener nofollow noreferrer" href=https://zzmzaw.github.io target=_blank>ZzMzaw's blog</a> © 2025 by <a rel="noopener nofollow noreferrer" href=https://zzmzaw.github.io/about target=_blank>ZzMzaw</a> is licensed under <a rel="noopener nofollow noreferrer" href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank>CC BY-SA 4.0</a> <img alt="Creative Commons logo" src=/img/cc/cc.svg#cc> <img alt="Creative Commons By icon" src=/img/cc/by.svg#cc> <img alt="Creative Commons SA icon" src=/img/cc/sa.svg#cc></p> Powered by <a rel="noopener noreferrer" href=https://www.getzola.org target=_blank>Zola</a> & <a rel="noopener noreferrer" href=https://github.com/welpo/tabi target=_blank>tabi</a> • <a rel="noopener noreferrer" href=https://github.com/ZzMzaw/zzmzaw.github.io target=_blank> Site source </a></small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>